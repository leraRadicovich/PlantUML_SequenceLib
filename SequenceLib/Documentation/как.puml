@startuml
!include C:\Users\Vpatrushev\IdeaProjects\PlantUML_SequenceLib\SequenceLib\src\SequenceLibIncludeFile_v4.puml
diagramInit(final,"Диаграмма для AnalystDays")
parties(participant,"AuthServer",srv,1)

rq(user,srv,++,"Запрос **аутентификации по паролю**","Комментарий для таблицы")
audit(AUTH_LOGIN,,"Вход по паролю",srv)
todo("Переименовать событие аудита")
rs(srv,srv,,"Обработка запроса","")
anchor(st1)
ALT(moccasin,"passLoginEnabled = false")
    todo("Реализовать обработку параметра passLoginEnabled")
    config(passLoginEnabled, boolean)
    rs(srv,user,...,"Воспользуйтесь альтернативным\nспособом входа","Вход по паролю отключен")
    audit(AUTH_LOGIN,FAILURE,"Вход по паролю отключен",srv)
ELSE(,"passLoginEnabled = true")
    ALT(orange,"Ошибка пароля")
        rs(*,3,...,"Вход НЕ разрешен","Введен неверный пароль")
        audit(AUTH_LOGIN,FAILURE,"Введен неверный пароль",srv)
    END()
END()
rs(srv,user,--,"Вход разрешен","Пользователь попал в авторизованную зону")
audit(AUTH_LOGIN,SUCCESS,"Осуществлен вход по паролю",srv)
anchor(st2)
rq(,,++,"Повторный вход","Повторный вход возможен в пределах 15 минут")
note across: Повторяются шаги: st1 - st2
HELP()
LEGEND()
ORIGINAL()
@enduml