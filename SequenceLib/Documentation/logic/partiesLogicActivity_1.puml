@startuml
title "AliasController"
legend top left
Легенда диаграммы
====
1. ввести в редакторе "имя процедуры/ функции" - вызвать в редакторе плагина plantUml пользовтельскуй процедуру/функцию - интерфейс
2. Вызвать "действие/ имя процедуры функции" - вызов процедуры/функции внутри другой процедуры функции
3. repeat - обозначение цикла foreach
4. Действие (например найти/сформировать) - обозначение простой функции/процедуры
5. Сложные процедуры/функции - состоят из проверок, циклов и вызовов простых процедур/функций, объединены в пакеты
6. Примеры объединены в группы, в названии которых указано - это примеры
end legend

start
:Ввести parties;
group Примеры ввода #moccasin
    split
    :parties(user);
    split again
    :parties("user,kafka");
    split again
    :parties("participant", "Имя участника", алиас, порядок);
    end split
end group

package parties #tan
    :Вызвать partyInputController;
end group
package partyInputController #tan
    :Создать пустой массив $aliasArrayToCheck;
    :Проверить заполненные поля: тип, имя, алиас, порядок;
    if (Заполнен только тип,\nт.е. передан массив, и\nостальные поля пустые?) then (Нет)
        :Создать заполненный объект $aliasToCheck,
        {"alias": {
            "type":"value",
            "name":"value",
            "order":"value"}};
        :Добавить сформированный объект $aliasToCheck
        в массив $aliasArrayToCheck;
    else (Да)
        :Вызвать функцию commonFeatures\stringToArray, чтобы
        сформировать массив объектов из переданных алиасов.
        Алиасы, переданы через запятую, в поле тип процедуры parties;
        repeat:ЦИКЛ foreach item in stringToArray
            :Создать пустой объект $aliasToCheck {"alias":""};
            :Добавить сформированный объект $aliasToCheck
            в массив $aliasArrayToCheck;
        repeat while (Весь массив обработан?) is (Нет) not (Да)
    endif
    :Вызвать checkAliasInCurrentAliasMap;
    end group
    package checkAliasInCurrentAliasMap #antiquewhite
        repeat:ЦИКЛ foreach item in $aliasArrayToCheck
        :Вызвать findAlias:\nНайти алиас в $currentAliasMap;
        if(Найден?) then(Да)
        else(Нет)
            :Вызвать findAlias:
            Найти алиас в $customAliasMap;
            if(Найден?) then(Нет)
                :вызвать тудушку: добавьте интеграцию с алисаом;
                :Вызвать функцию tempPartyNameBuilder,
                 обновить name для текущего объекта;
                :Вызвать функцию tempPartyTypeBuilder,
                обновить type для текущего объекта;
            else(Да)
                if(Имя в $aliasArrayToCheck пустое?) then(Да)
                    :Достать имя из $customAliasMap,
                    обновить name для текущего объекта;
                else(Нет)
                    if(Имя из $aliasArrayToCheck совпадает\nс именем из $customAliasMap) then(Нет)
                        :Вызвать тудушку: В текущей диаграмме используется alias,
                        уже присутствующий в $customAliasMap с другим именем.
                        Измените его перед добавлением в $customAliasMap.;
                    else(Да)
                    endif
                endif
                if(Тип в $aliasArrayToCheck пустой?) then(Да)
                    :Достать тип из $customAliasMap,
                    обновить type для текущего объекта;
                else(Нет)
                    if(Тип из $aliasArrayToCheck совпадает\nс типом из $customAliasMap) then(Нет)
                        :Вызвать тудушку: В текущей диаграмме используется alias,
                        уже присутствующий в $customAliasMap с другим типом.
                        Измените его перед добавлением в $customAliasMap.;
                    else(Да)
                    endif
                endif
            endif
            :Добавить нового участника в $currentAliasMap;
        endif

    repeat while (Весь массив обработан?) is (Нет) not (Да)
    :Вызвать partiesOutputController
    для обновленного $aliasArrayToCheck;
    end group


@enduml
